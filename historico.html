<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hist√≥rico de Medi√ß√µes - EroWatch</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/historico.css" />
    <link rel="icon" type="image/png" href="/assets/logo.erowatch.png" />
  </head>
  <body>
    <div class="dashboard-container">
      <!-- BARRA LATERAL -->
      <header class="main-header">
        <div class="sidebar-top">
          <div class="logo">
            <figure>
              <img src="assets/logo.erowatch.png" alt="Logo do EroWatch" />
            </figure>
          </div>

          <div class="lado">
            <h1>EroWatch</h1>
            <p>Hist√≥rico de Dados</p>
          </div>
        </div>

        <nav class="sidebar-nav">
          <div class="status-sistema-container">
            <div class="status-badge" id="statusBadge">
              <span class="status-icon">‚è≥</span>
              <span class="status-texto">Carregando...</span>
            </div>

            <div class="status-tooltip">
              <div class="tooltip-header">
                <strong>Status do Sistema</strong>
              </div>
              <div class="tooltip-content">
                <div class="tooltip-item">
                  <span class="tooltip-icon">üî¥</span>
                  <span class="tooltip-label">Cr√≠tico:</span>
                  <span class="tooltip-value" id="tooltipCritico">0</span>
                </div>
                <div class="tooltip-item">
                  <span class="tooltip-icon">üü†</span>
                  <span class="tooltip-label">Alto:</span>
                  <span class="tooltip-value" id="tooltipAlto">0</span>
                </div>
                <div class="tooltip-item">
                  <span class="tooltip-icon">üü°</span>
                  <span class="tooltip-label">M√©dio:</span>
                  <span class="tooltip-value" id="tooltipMedio">0</span>
                </div>
                <div class="tooltip-item">
                  <span class="tooltip-icon">üü¢</span>
                  <span class="tooltip-label">Baixo:</span>
                  <span class="tooltip-value" id="tooltipBaixo">0</span>
                </div>
              </div>
              <div class="tooltip-footer">
                <strong>Total: <span id="tooltipTotal">0</span></strong>
                <small id="tooltipUpdate">Atualizado agora</small>
              </div>
            </div>
          </div>
          <div class="nav-links menu-items">
            <a href="index.html"> <span class="icon"></span> Dashboard </a>
            <a href="historico.html" class="active">
              <span class="icon"></span> Hist√≥rico
            </a>
          </div>
        </nav>
      </header>

      <!-- CONTE√öDO PRINCIPAL -->
      <div class="content-wrapper">
        <main style="padding: 20px">
          <div class="page-header-control">
            <h2>Base de Conhecimento</h2>
            <a href="index.html" class="nav-back"> ‚Üê Voltar ao Dashboard </a>
          </div>

          <!-- SE√á√ÉO DE FILTROS -->
          <section class="filters-section">
            <h3>üîç Filtros de Busca</h3>

            <div class="filters-grid">
              <div class="filter-group">
                <label for="filterSensor">Sensor</label>
                <select id="filterSensor">
                  <option value="">Todos os sensores</option>
                </select>
              </div>

              <div class="filter-group">
                <label for="filterRisco">N√≠vel de Risco</label>
                <select id="filterRisco">
                  <option value="">Todos os n√≠veis</option>
                  <option value="BAIXO">Baixo</option>
                  <option value="MEDIO">M√©dio</option>
                  <option value="ALTO">Alto</option>
                </select>
              </div>

              <div class="filter-group">
                <label for="filterDataInicio">Data In√≠cio</label>
                <input type="datetime-local" id="filterDataInicio" />
              </div>

              <div class="filter-group">
                <label for="filterDataFim">Data Fim</label>
                <input type="datetime-local" id="filterDataFim" />
              </div>
            </div>

            <div class="filter-actions">
              <button class="btn btn-secondary" onclick="limparFiltros()">
                Limpar
              </button>
              <button class="btn btn-primary" onclick="aplicarFiltros()">
                Buscar
              </button>
            </div>
          </section>

          <!-- TABELA DE MEDI√á√ïES -->
          <section class="measurements-table">
            <div class="table-header">
              <h2>Medi√ß√µes Registradas</h2>
              <button class="export-btn" onclick="exportarCSV()">
                Exportar CSV
              </button>
            </div>

            <div id="loadingIndicator" class="loading">
              üîÑ Carregando dados...
            </div>

            <div id="tableContainer" style="display: none">
              <table>
                <thead>
                  <tr>
                    <th>Data/Hora</th>
                    <th>Sensor</th>
                    <th>Umidade Solo</th>
                    <th>Temp. Solo</th>
                    <th>Umidade Ar</th>
                    <th>Temp. Ar</th>
                    <th>Inclina√ß√£o</th>
                    <th>N√≠vel de Risco</th>
                    <th>Alerta Chuva</th>
                  </tr>
                </thead>
                <tbody id="measurementsBody">
                  <!-- Dados inseridos via JS -->
                </tbody>
              </table>

              <div class="pagination">
                <button id="prevPage" onclick="mudarPagina(-1)">
                  ‚Üê Anterior
                </button>
                <span class="page-info" id="pageInfo">P√°gina 1</span>
                <button id="nextPage" onclick="mudarPagina(1)">
                  Pr√≥xima ‚Üí
                </button>
              </div>
            </div>

            <div id="noData" class="no-data" style="display: none">
              üì≠ Nenhuma medi√ß√£o encontrada com os filtros selecionados.
            </div>
          </section>
        </main>
      </div>
    </div>

    <script src="javascript/api.js"></script>
    <script src="javascript/historico.js"></script>
    <script src="javascript/status-sistema.js"></script>
  </body>
</html>
