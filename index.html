<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EroWatch - Monitoramento de Eros√£o</title>
    <!-- Importando fonte moderna -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css" />
    <link rel="icon" type="image/png" href="/assets/logo.erowatch.png" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="javascript/status-sistema.js"></script>
  </head>
  <body>
    <div class="dashboard-container">
      <!-- BARRA LATERAL (Antigo Header) -->
      <header class="main-header">
        <div class="sidebar-top">
          <div class="logo">
            <figure>
              <img src="assets/logo.erowatch.png" alt="Logo do EroWatch" />
            </figure>
          </div>

          <div class="lado">
            <h1>EroWatch</h1>
            <p>Monitoramento Inteligente</p>
          </div>
        </div>

        <nav class="sidebar-nav">
          <!-- NOVO: Componente de Status do Sistema -->
          <div class="status-sistema-container">
            <div class="status-badge" id="statusBadge">
              <span class="material-icons status-icon">hourglass_empty</span>
              <span class="status-texto">Carregando...</span>
            </div>

            <div class="status-tooltip">
              <div class="tooltip-header">
                <strong>Status do Sistema</strong>
              </div>
              <div class="tooltip-content">
                <div class="tooltip-item">
                  <span class="material-icons tooltip-icon" style="color: var(--risk-high)">error</span>
                  <span class="tooltip-label">Cr√≠tico:</span>
                  <span class="tooltip-value" id="tooltipCritico">0</span>
                </div>
                <div class="tooltip-item">
                  <span class="material-icons tooltip-icon" style="color: var(--risk-medium)">warning</span>
                  <span class="tooltip-label">Alto:</span>
                  <span class="tooltip-value" id="tooltipAlto">0</span>
                </div>
                <div class="tooltip-item">
                  <span class="material-icons tooltip-icon" style="color: #ffc107">info</span>
                  <span class="tooltip-label">M√©dio:</span>
                  <span class="tooltip-value" id="tooltipMedio">0</span>
                </div>
                <div class="tooltip-item">
                  <span class="material-icons tooltip-icon" style="color: var(--risk-low)">check_circle</span>
                  <span class="tooltip-label">Baixo:</span>
                  <span class="tooltip-value" id="tooltipBaixo">0</span>
                </div>
              </div>
              <div class="tooltip-footer">
                <strong>Total: <span id="tooltipTotal">0</span></strong>
                <small id="tooltipUpdate">Atualizado agora</small>
              </div>
            </div>
          </div>

          <!-- SELETOR DE SENSOR (NOVO) -->
          <div class="sensor-selector-container" style="padding: 0 15px 15px 15px; border-bottom: 1px solid var(--border-color); margin-bottom: 15px;">
            <label for="dashboardSensorSelect" style="display: block; margin-bottom: 8px; font-size: 0.85em; color: white; font-weight: 600;">
                <span class="material-icons" style="font-size: 14px; vertical-align: middle;">place</span> LOCALIZA√á√ÉO
            </label>
            <select id="dashboardSensorSelect" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-card); color: var(--text-primary); cursor: pointer; font-family: 'Inter', sans-serif;">
                <option value="">üåé Vis√£o Geral</option>
            </select>
          </div>

          <div class="nav-links menu-items">
            <a href="index.html" class="active">
              <span class="material-icons">dashboard</span> Dashboard
            </a>
            <a href="historico.html"> <span class="material-icons">history</span> Hist√≥rico </a>
            <div class="live-indicator">
              <span class="dot"></span> Tempo Real
            </div>
          </div>
          
          <!-- Bot√£o de Tema -->
          <div class="theme-toggle-container">
            <button id="themeToggleBtn" class="theme-btn-sidebar">
              <span class="material-icons">dark_mode</span> Modo Escuro
            </button>
            <a href="admin/login.html" class="theme-btn-sidebar" style="margin-top: 10px; text-decoration: none; justify-content: center;">
                <span class="material-icons">login</span> √Årea Restrita
            </a>
          </div>
        </nav>
      </header>

      <!-- CONTE√öDO PRINCIPAL (Direita) -->
      <div class="content-wrapper">
        <section class="risk-alerts">
          <div class="header-title-row">
            <div class="icons">
              <div class="top-img">
                <span class="material-icons" style="font-size: 40px; color: var(--risk-high);">notifications_active</span>
              </div>
              <div class="top-text">
                <h2>Alertas de Risco</h2>
                <p class="subtitle">
                  Monitoramento em tempo real de √°reas vulner√°veis
                </p>
              </div>
            </div>
          </div>
          <!-- Alertas inseridos via JS -->
        </section>

        <main class="data-panel">
          <section class="climate-monitoring">
            <div class="section-header">
              <div class="icons">
                <span class="material-icons section-icon" style="font-size: 45px; color: var(--primary-color);">thunderstorm</span>
                <div class="text-top">
                  <h2>Clima</h2>
                  <p class="subtitle">Condi√ß√µes Meteorol√≥gicas</p>
                </div>
              </div>
            </div>

            <div class="stat-card highlight-card" id="climaCard">
              <span class="stat-label">Chuva Prevista (24h)</span>
              <p class="stat-value">-<small>mm</small></p>
              <span class="stat-indicator" id="riscoClimaIndicator"
                >Aguardando dados...</span
              >
            </div>

            <div class="stats-grid">
              <div class="stat-card">
                <span class="stat-label">Chuva Agora</span>
                <p class="stat-value" id="chuva-agora">-<small>mm</small></p>
              </div>
              <div class="stat-card">
                <span class="stat-label">Umidade Ar</span>
                <p class="stat-value" id="umidade-ar">-<small>%</small></p>
              </div>
              <div class="stat-card">
                <span class="stat-label">Vento</span>
                <p class="stat-value" id="vento-ar">-<small>km/h</small></p>
              </div>
              <div class="stat-card">
                <span class="stat-label">Temp. Ar</span>
                <p class="stat-value" id="temperatura-ar">-<small>¬∞C</small></p>
              </div>
            </div>

            <div class="chart-box precipitation-chart">
              <h3>Precipita√ß√£o (7 dias)</h3>
              <canvas id="precipitationChart"></canvas>
            </div>

            <div class="chart-box temp-humidity-chart">
              <h3>Temperatura & Umidade</h3>
              <canvas id="tempHumidityChart"></canvas>
            </div>
          </section>

          <section class="soil-metrics">
            <div class="section-header">
              <div class="icons">
                <span class="material-icons section-icon" style="font-size: 45px; color: var(--secondary-color);">landscape</span>
                <div class="text-top">
                  <h2>Solo <span class="badge-solo" id="tipo-solo-badge" style="font-size: 0.6em; background: #e9ecef; padding: 2px 8px; border-radius: 10px; color: #495057;">--</span></h2>
                  <p class="subtitle">F√≠sica e Geologia</p>
                </div>
              </div>
            </div>

            <div class="stats-grid">
              <div class="stat-card">
                <span class="stat-label">Umidade Solo</span>
                <p class="stat-value" id="umidade-solo">-<small>%</small></p>
              </div>
              <div class="stat-card">
                <span class="stat-label">Inclina√ß√£o</span>
                <p class="stat-value" id="inclinacao">-<small>¬∞</small></p>
              </div>
              <div class="stat-card risk-card">
                <span class="stat-label">Taxa de Eros√£o</span>
                <p class="stat-value risk-metric" id="taxa-erosao">
                  - <small>t/ha</small>
                </p>
              </div>
              <div class="stat-card">
                <span class="stat-label">Temp. Solo</span>
                <p class="stat-value" id="temperatura-solo">
                  -<small>¬∞C</small>
                </p>
              </div>
              <!-- NOVO CARD: Qualidade da Leitura -->
              <div class="stat-card">
                <span class="stat-label">Qualidade Sinal</span>
                <p class="stat-value" id="qualidade-leitura" style="font-size: 1.2rem;">-</p>
              </div>
            </div>

            <div class="chart-box inclination-chart">
              <h3>Inclina√ß√£o por √Årea</h3>
              <canvas id="inclinationChart"></canvas>
            </div>

            <div class="chart-box humidity-evolution-chart">
              <h3>Umidade (24h)</h3>
              <canvas id="humidityEvolutionChart"></canvas>
            </div>
          </section>

          <!-- Inserir o card do √çndice de Risco onde desejar no layout -->
          <div class="card">
            <h3>√çndice de Risco</h3>
            <div class="indice-container">
              <div class="indice-valor" id="indice-risco">0.0</div>
              <div class="indice-barra">
                <div class="indice-progresso" id="barra-risco"></div>
              </div>
            </div>
          </div>

          <div class="card">
            <h3>Recomenda√ß√£o</h3>
            <p id="recomendacao">Aguardando dados...</p>
          </div>
        </main>
      </div>
      <!-- Fim do content-wrapper -->
    </div>

    <script src="javascript/script.js"></script>
    <script src="javascript/api.js"></script>
    <script src="javascript/theme.js"></script>
  </body>
</html>
